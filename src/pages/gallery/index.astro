---
import Layout from '../../layouts/Layout.astro';
import CardFolder from '../../components/cards/CardFolder.astro';
import { formatDate } from '../../utility/scripts/format-fxn.js';

import { Image } from "astro:assets";
import { getCollection } from "astro:content";

import GalleryThumbs from "../../components/GalleryThumbs.astro";

import '../../utility/styles/card-styles.css';
import '../../utility/styles/wrapper-styles.css';

import CardConstruction from '../../components/cards/CardConstruction.astro';

import placeholderImage from "./abstract_daughter.png";

// import { sortEntries, sortByCreationDate, sortByUploadDate } from '../../../utility/utils';

const entries = await getCollection("entries");   
// const chronoEntries = entries.toReversed();        

const galleryEntries = entries.filter((entry => entry.data.gallery === true)).toReversed();

const originalEntries = galleryEntries.filter((entry => entry.data.tags.includes("original")));
const fanartEntries = galleryEntries.filter((entry => entry.data.tags.includes("fanart")));

const sketchEntries = galleryEntries.filter((entry => entry.data.tags.includes("sketchbook")));
const sketchDigital = sketchEntries.filter((entry => entry.data.tags.includes("digital")));
const sketchAnalog = sketchEntries.filter((entry => entry.data.tags.includes("analog")));

const studyEntries = galleryEntries.filter((entry => entry.data.tags.includes("study")));
const studyDigital = studyEntries.filter((entry => entry.data.tags.includes("digital")));
const studyAnalog = studyEntries.filter((entry => entry.data.tags.includes("analog")));

const commissionEntries = galleryEntries.filter((entry => entry.data.tags.includes("commission")));
const commissionSimple = commissionEntries.filter((entry => entry.data.commstyle === "full"));
const commissionFull = commissionEntries.filter((entry => entry.data.commstyle === "simple"));
console.log(commissionFull)

function filterEntries(entries) {}

// const personalEntries = galleryEntries.filter((entry) => {
//     if (entry.data.tags.includes("personal")) {
//         console.log("no");
//         return entry;
//     }});



---

<Layout title="GALLERY">

    <main>

        <h1>GALLERY</h1>
        <CardConstruction>
            <p>this page is currently under construction.</p>
        </CardConstruction>

            <div class="card gallery-card" id="display">
                <div class="image">
                    <h1 class="card-title">GALLERY</h1>
                    <figure>
                        <Image class="full-size"
                            src={placeholderImage}
                            alt=""
                        />
                        <figcaption>
                            <p class="title">NAVIGATION</p>
                            
                            <p>click on the <b>tabs</b> to navigate between sections, the <b>thumbnails</b> to view the full images, and the <b>images</b> to open them in a new tab</p>

                        </figcaption>
                    </figure>
                </div>
            </div>

            <div class="folder-wrapper">
                <div class="folder">
                    <CardFolder
                        tabTitle="ILLUSTRATION"
                        id="illustration"
                        index={true}
                    >

                        <h4>PERSONAL</h4>
                        <div class="thumbnail-container">
                            { originalEntries.map((entry) => (
                                <a href="#display">
                                    <GalleryThumbs
                                            title={entry.data.title}
                                            thumb={entry.data.thumb.src}
                                            date={entry.data.date}
                                            Nsfw={entry.data.Nsfw}
                                            Dd={entry.data.Dd}
                                            desc={entry.data.desc}
                                            original={entry.data.original}
                                            medium={entry.data.medium}
                                            image={entry.data.image.src}
                                            thumb={entry.data.thumb.src}
                                            src={entry.data.image.src.src}
                                    />
                                </a>
                            ))}
                        </div>

                        <h4>FANWORKS</h4>
                        <div class="thumbnail-container">
                            { fanartEntries.map((entry) => (
                                <a href="#display">
                                    <GalleryThumbs
                                            title={entry.data.title}
                                            thumb={entry.data.thumb.src}
                                            date={entry.data.date}
                                            Nsfw={entry.data.Nsfw}
                                            Dd={entry.data.Dd}
                                            desc={entry.data.desc}
                                            original={entry.data.original}
                                            medium={entry.data.medium}
                                            image={entry.data.image.src}
                                            thumb={entry.data.thumb.src}
                                            src={entry.data.image.src.src}
                                    />
                                </a>
                            ))}
                        </div>

                    </CardFolder>
                    <CardFolder
                        tabTitle="SKETCHBOOK"
                        id="sketchbook"
                        index={false}
                    >
                        <h4>DIGITAL</h4>
                        <div class="thumbnail-container">
                            { sketchDigital.map((entry) => (
                                <a href="#display">
                                    <GalleryThumbs
                                            title={entry.data.title}
                                            thumb={entry.data.thumb.src}
                                            date={entry.data.date}
                                            Nsfw={entry.data.Nsfw}
                                            Dd={entry.data.Dd}
                                            desc={entry.data.desc}
                                            original={entry.data.original}
                                            medium={entry.data.medium}
                                            image={entry.data.image.src}
                                            thumb={entry.data.thumb.src}
                                            src={entry.data.image.src.src}
                                    />
                                    </a>
                                ))}
                        </div>
                        <h4>ANALOG</h4>
                        <div class="thumbnail-container">
                            { sketchAnalog.map((entry) => (
                                <a href="#display">
                                    <GalleryThumbs
                                            title={entry.data.title}
                                            thumb={entry.data.thumb.src}
                                            date={entry.data.date}
                                            Nsfw={entry.data.Nsfw}
                                            Dd={entry.data.Dd}
                                            desc={entry.data.desc}
                                            original={entry.data.original}
                                            medium={entry.data.medium}
                                            image={entry.data.image.src}
                                            thumb={entry.data.thumb.src}
                                            src={entry.data.image.src.src}
                                    />
                                    </a>
                                ))}
                        </div>
                    </CardFolder>

                    <CardFolder
                        tabTitle="COMMISSIONS"
                        id="commissions"
                        index={false}
                    >
                    <h4>SIMPLE COLOR</h4>
                    <div class="thumbnail-container">
                        { commissionSimple.map((entry) => (
                            <a href="#display">
                                <GalleryThumbs
                                        title={entry.data.title}
                                        thumb={entry.data.thumb.src}
                                        date={entry.data.date}
                                        Nsfw={entry.data.Nsfw}
                                        Dd={entry.data.Dd}
                                        desc={entry.data.desc}
                                        original={entry.data.original}
                                        medium={entry.data.medium}
                                        image={entry.data.image.src}
                                        thumb={entry.data.thumb.src}
                                        commstyle={entry.data.commstyle}
                                        src={entry.data.image.src.src}
                                />
                            </a>
                        ))}
                    </div>

                    <h4>FULL COLOR</h4>
                    <div class="thumbnail-container">
                        { commissionFull.map((entry) => (
                            <a href="#display">
                                <GalleryThumbs
                                        title={entry.data.title}
                                        thumb={entry.data.thumb.src}
                                        date={entry.data.date}
                                        Nsfw={entry.data.Nsfw}
                                        Dd={entry.data.Dd}
                                        desc={entry.data.desc}
                                        original={entry.data.original}
                                        medium={entry.data.medium}
                                        image={entry.data.image.src}
                                        thumb={entry.data.thumb.src}
                                        commstyle={entry.data.commstyle}
                                        src={entry.data.image.src.src}
                                />
                            </a>
                        ))}
                    </div>
                    </CardFolder>
                
                    <CardFolder
                        tabTitle="STUDIES"
                        id="studies"
                        index={false}
                    >
                        <h4>DIGITAL</h4>
                        <div class="thumbnail-container">
                            { studyDigital.map((entry) => (
                                <a href="#display">
                                    <GalleryThumbs
                                            title={entry.data.title}
                                            thumb={entry.data.thumb.src}
                                            date={entry.data.date}
                                            Nsfw={entry.data.Nsfw}
                                            Dd={entry.data.Dd}
                                            desc={entry.data.desc}
                                            original={entry.data.original}
                                            medium={entry.data.medium}
                                            image={entry.data.image.src}
                                            thumb={entry.data.thumb.src}
                                            src={entry.data.image.src.src}
                                    />
                                </a>
                            ))}
                        </div>
                        <h4>ANALOG</h4>
                        <div class="thumbnail-container">
                            { studyAnalog.map((entry) => (
                                <a href="#display">
                                    <GalleryThumbs
                                            title={entry.data.title}
                                            thumb={entry.data.thumb.src}
                                            date={entry.data.date}
                                            Nsfw={entry.data.Nsfw}
                                            Dd={entry.data.Dd}
                                            desc={entry.data.desc}
                                            original={entry.data.original}
                                            medium={entry.data.medium}
                                            image={entry.data.image.src}
                                            thumb={entry.data.thumb.src}
                                            src={entry.data.image.src.src}
                                    />
                                    </a>
                                ))}
                        </div>
                    </CardFolder>
                </div>
            </div>

    
</main>

</Layout>

<style>


</style>

<script>

const displayCard = document.getElementById("display");
console.log(displayCard)

const thumbnails = document.querySelectorAll('.thumbnail-container .image');
const fullsizeDisplay = document.querySelector('.gallery-card .image');

thumbnails.forEach(thumbnail => {
    thumbnail.addEventListener('click', function() {
        const thumbFig = thumbnail.querySelector("figure");
        const fullsizeFig = fullsizeDisplay?.querySelector("figure");
        // const thumbTitle = thumbnail.querySelector("h2");
        // const fullsizeTitle = fullsizeDisplay?.querySelector("h2");
        if (!thumbFig || !fullsizeFig) {
            return;
        }
        fullsizeDisplay?.replaceChild(thumbFig.cloneNode(true), fullsizeFig);
    })
});

</script>